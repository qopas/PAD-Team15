{
    "info": {
        "name": "User Management API",
        "description": "Collection for testing User Management API endpoints",
        "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
    },
    "item": [
        {
            "name": "Health Check",
            "request": {
                "method": "GET",
                "header": [],
                "url": {
                    "raw": "{{base_url}}/api/health",
                    "host": ["{{base_url}}"],
                    "path": ["api", "health"]
                }
            },
            "event": [
                {
                    "listen": "test",
                    "script": {
                        "exec": [
                            "pm.test('Status code is 200', function () {",
                            "    pm.response.to.have.status(200);",
                            "});",
                            "",
                            "pm.test('Response has correct structure', function () {",
                            "    const jsonData = pm.response.json();",
                            "    pm.expect(jsonData).to.have.property('status');",
                            "    pm.expect(jsonData).to.have.property('message');",
                            "    pm.expect(jsonData.status).to.eql('success');",
                            "});"
                        ],
                        "type": "text/javascript"
                    }
                }
            ]
        },
        {
            "name": "Create User",
            "request": {
                "method": "POST",
                "header": [
                    {
                        "key": "Content-Type",
                        "value": "application/json"
                    },
                    {
                        "key": "Accept",
                        "value": "application/json"
                    }
                ],
                "body": {
                    "mode": "raw",
                    "raw": "{\n    \"name\": \"John Doe\",\n    \"email\": \"john.doe@example.com\",\n    \"password\": \"password123\",\n    \"role\": \"student\",\n    \"group\": \"FAF-211\"\n}"
                },
                "url": {
                    "raw": "{{base_url}}/api/users",
                    "host": ["{{base_url}}"],
                    "path": ["api", "users"]
                }
            },
            "event": [
                {
                    "listen": "test",
                    "script": {
                        "exec": [
                            "pm.test('Status code is 201', function () {",
                            "    pm.response.to.have.status(201);",
                            "});",
                            "",
                            "pm.test('Response has correct structure', function () {",
                            "    const jsonData = pm.response.json();",
                            "    pm.expect(jsonData).to.have.property('status');",
                            "    pm.expect(jsonData).to.have.property('message');",
                            "    pm.expect(jsonData).to.have.property('data');",
                            "    pm.expect(jsonData.status).to.eql('success');",
                            "});",
                            "",
                            "pm.test('User data is correct', function () {",
                            "    const jsonData = pm.response.json();",
                            "    const userData = jsonData.data;",
                            "    pm.expect(userData).to.have.property('id');",
                            "    pm.expect(userData).to.have.property('name');",
                            "    pm.expect(userData).to.have.property('email');",
                            "    pm.expect(userData).to.have.property('role');",
                            "    pm.expect(userData.name).to.eql('John Doe');",
                            "    pm.expect(userData.email).to.eql('john.doe@example.com');",
                            "    pm.expect(userData.role).to.eql('student');",
                            "});",
                            "",
                            "pm.test('Password is not returned', function () {",
                            "    const jsonData = pm.response.json();",
                            "    const userData = jsonData.data;",
                            "    pm.expect(userData).to.not.have.property('password');",
                            "});",
                            "",
                            "// Save user ID for other tests",
                            "if (pm.response.code === 201) {",
                            "    const jsonData = pm.response.json();",
                            "    pm.environment.set('user_id', jsonData.data.id);",
                            "}"
                        ],
                        "type": "text/javascript"
                    }
                }
            ]
        },
        {
            "name": "Get All Users",
            "request": {
                "method": "GET",
                "header": [
                    {
                        "key": "Accept",
                        "value": "application/json"
                    }
                ],
                "url": {
                    "raw": "{{base_url}}/api/users",
                    "host": ["{{base_url}}"],
                    "path": ["api", "users"]
                }
            },
            "event": [
                {
                    "listen": "test",
                    "script": {
                        "exec": [
                            "pm.test('Status code is 200', function () {",
                            "    pm.response.to.have.status(200);",
                            "});",
                            "",
                            "pm.test('Response has correct structure', function () {",
                            "    const jsonData = pm.response.json();",
                            "    pm.expect(jsonData).to.have.property('status');",
                            "    pm.expect(jsonData).to.have.property('data');",
                            "    pm.expect(jsonData.status).to.eql('success');",
                            "    pm.expect(jsonData.data).to.be.an('array');",
                            "});"
                        ],
                        "type": "text/javascript"
                    }
                }
            ]
        },
        {
            "name": "Get User by ID",
            "request": {
                "method": "GET",
                "header": [
                    {
                        "key": "Accept",
                        "value": "application/json"
                    }
                ],
                "url": {
                    "raw": "{{base_url}}/api/users/{{user_id}}",
                    "host": ["{{base_url}}"],
                    "path": ["api", "users", "{{user_id}}"]
                }
            },
            "event": [
                {
                    "listen": "test",
                    "script": {
                        "exec": [
                            "pm.test('Status code is 200', function () {",
                            "    pm.response.to.have.status(200);",
                            "});",
                            "",
                            "pm.test('Response has user data', function () {",
                            "    const jsonData = pm.response.json();",
                            "    pm.expect(jsonData).to.have.property('status');",
                            "    pm.expect(jsonData).to.have.property('data');",
                            "    pm.expect(jsonData.status).to.eql('success');",
                            "    pm.expect(jsonData.data).to.have.property('id');",
                            "});"
                        ],
                        "type": "text/javascript"
                    }
                }
            ]
        },
        {
            "name": "Get Users by Role",
            "request": {
                "method": "GET",
                "header": [
                    {
                        "key": "Accept",
                        "value": "application/json"
                    }
                ],
                "url": {
                    "raw": "{{base_url}}/api/users/role/student",
                    "host": ["{{base_url}}"],
                    "path": ["api", "users", "role", "student"]
                }
            },
            "event": [
                {
                    "listen": "test",
                    "script": {
                        "exec": [
                            "pm.test('Status code is 200', function () {",
                            "    pm.response.to.have.status(200);",
                            "});",
                            "",
                            "pm.test('Response contains only students', function () {",
                            "    const jsonData = pm.response.json();",
                            "    pm.expect(jsonData).to.have.property('data');",
                            "    pm.expect(jsonData.data).to.be.an('array');",
                            "    ",
                            "    if (jsonData.data.length > 0) {",
                            "        jsonData.data.forEach(user => {",
                            "            pm.expect(user.role).to.eql('student');",
                            "        });",
                            "    }",
                            "});"
                        ],
                        "type": "text/javascript"
                    }
                }
            ]
        },
        {
            "name": "Update User",
            "request": {
                "method": "PUT",
                "header": [
                    {
                        "key": "Content-Type",
                        "value": "application/json"
                    },
                    {
                        "key": "Accept",
                        "value": "application/json"
                    }
                ],
                "body": {
                    "mode": "raw",
                    "raw": "{\n    \"name\": \"John Updated\",\n    \"group\": \"FAF-212\"\n}"
                },
                "url": {
                    "raw": "{{base_url}}/api/users/{{user_id}}",
                    "host": ["{{base_url}}"],
                    "path": ["api", "users", "{{user_id}}"]
                }
            },
            "event": [
                {
                    "listen": "test",
                    "script": {
                        "exec": [
                            "pm.test('Status code is 200', function () {",
                            "    pm.response.to.have.status(200);",
                            "});",
                            "",
                            "pm.test('User was updated', function () {",
                            "    const jsonData = pm.response.json();",
                            "    pm.expect(jsonData).to.have.property('status');",
                            "    pm.expect(jsonData).to.have.property('message');",
                            "    pm.expect(jsonData.status).to.eql('success');",
                            "    pm.expect(jsonData.data.name).to.eql('John Updated');",
                            "});"
                        ],
                        "type": "text/javascript"
                    }
                }
            ]
        }
    ],
    "variable": [
        {
            "key": "base_url",
            "value": "http://localhost:8081",
            "type": "string"
        },
        {
            "key": "user_id",
            "value": "",
            "type": "string"
        }
    ]
}